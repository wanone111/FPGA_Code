


<!DOCTYPE HTML>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		<meta content="Vision, Library, Vitis Vision AIE Library, overview, features, kernel" name="keywords" />
<meta content="Using the Vitis Vision AIE library." name="description" />
<meta content="Document" name="xlnxdocumentclass" />
<meta content="Tutorials" name="xlnxdocumenttype" />
<meta content="Vision, Library, Vitis Vision AIE Library, design, methodology, AIE, ADF, ACAP, OpenCV" name="keywords" />
<meta content="Describes Describes the methodology to accelerate Vitis Vision AIE library functions on Versal adaptive compute acceleration platforms (ACAPs)" name="description" />
<meta content="Document" name="xlnxdocumentclass" />
<meta content="Tutorials" name="xlnxdocumenttype" />

		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.4382/css/CoveoFullSearch.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description"/>
		<meta name="keywords"/>
		<meta property="og:title" content=""/>
		<meta property="og:description"/>
		<!-- favicon -->
		<link rel="icon" type="image/vnd.microsoft.icon" href="_static/favicon.ico"/>
		<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="_static/favicon.ico"/>
		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css"/>

	<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="37701bd4-e5c0-4ee3-9329-e7475d0b13a7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
		<!-- Google Tag Manager -->
	<script type="text/plain" class="optanon-category-C0002">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-5RHQV7');</script>
	<!-- End Google Tag Manager -->
	
        <!-- Google Tag Manager -->
        <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5RHQV7" height="0" width="0" style="display:none;visibility:hidden" class="optanon-category-C0002"></iframe></noscript>
        <!-- End Google Tag Manager -->	

  
  
  
  

  
      <script type="text/javascript" src="_static/js/jquery.min.js"></script>
	  <script type="text/javascript" src="_static/js/gtm.js"></script>
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
    <script type="text/javascript" src="_static/js/d3dd8c60ed.js"></script>
    <script type="text/javascript" src="_static/js/common-ui-all.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="_static/js/CoveoJsSearch.Lazy.min.js"></script>
    <script type="text/javascript" src="_static/js/linkid.js"></script>
    <script type="text/javascript" src="_static/js/Searchbox.min.js"></script>
    <script type="text/javascript" src="_static/js/header-footer.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/common-ui-all.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/header-footer.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/pro.min.css" media="all" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Overview" href="api-reference.html" />
    <link rel="prev" title="Overview" href="overview.html" /> 
	</head>
	<body>
		<div class="xilinx-bs3"/>
		<div class="root responsivegrid">
			<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 aem-Grid--large--16 aem-Grid--xlarge--16 aem-Grid--xxlarge--16 aem-Grid--xxxlarge--16 ">
 <div class="xilinxExperienceFragments experiencefragment aem-GridColumn aem-GridColumn--default--12">

    
    

    



<div class="xf-content-height">
    

<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
    
    <div class="header parbase aem-GridColumn aem-GridColumn--default--12"><noindex>
	<header data-component="header" class="site-header">
		<nav class="navbar navbar-default">
			<div class="container-fluid main-nav">
				<div class="row">
					<div class="navbar-column col-xs-4 col-sm-5">
						<ul class="nav navbar-nav hidden-xs">
							<li>
									<button onclick="window.location.href=&#39;https://www.xilinx.com/applications.html&#39;;">Solutions</button>
								</li>
							<li>
									<button onclick="window.location.href=&#39;https://www.xilinx.com/products/silicon-devices.html&#39;;">Products</button>
								</li>
							<li>
									<button onclick="window.location.href=&#39;https://www.xilinx.com/about/company-overview.html&#39;;">Company</button>
								</li>
							</ul>
							
						<ul class="nav navbar-nav hidden-sm hidden-md hidden-lg">
							<li>
									<button data-target="#header-container-0" data-function="toggle">Solutions</button>
								</li>
							<li>
									<button data-target="#header-container-1" data-function="toggle">Products</button>
								</li>
							<li>
									<button data-target="#header-container-2" data-function="toggle">Company</button>
								</li>
							</ul>
							
						<div id="header-container-0" class="menu-container">
								<div class="navbar-nav-container">
									<ul class="nav navbar-nav">
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/applications.html&#39;;">Solutions</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/products/silicon-devices.html&#39;;">Products</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/about/company-overview.html&#39;;">Company</button>
												</li>
										</ul>
									<button data-function="close-menu">
										<span class="fal fa-times" aria-hidden="true"></span>
									</button>
								</div>
							</div>
							<div id="header-container-1" class="menu-container">
								<div class="navbar-nav-container">
									<ul class="nav navbar-nav">
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/applications.html&#39;;">Solutions</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/products/silicon-devices.html&#39;;">Products</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/about/company-overview.html&#39;;">Company</button>
												</li>
										</ul>
									<button data-function="close-menu">
										<span class="fal fa-times" aria-hidden="true"></span>
									</button>
								</div>
							</div>
							<div id="header-container-2" class="menu-container">
								<div class="navbar-nav-container">
									<ul class="nav navbar-nav">
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/applications.html&#39;;">Solutions</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/products/silicon-devices.html&#39;;">Products</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/about/company-overview.html&#39;;">Company</button>
												</li>
										</ul>
									<button data-function="close-menu">
										<span class="fal fa-times" aria-hidden="true"></span>
									</button>
								</div>
							</div>
							</div>
					<div class="logo-column col-xs-4 col-sm-2">
						<div class="logo">
							<a target="_blank" href="https://www.xilinx.com/">
								<img src="https://github.com/Xilinx/Image-Collateral/blob/main/xilinx-header-logo.svg?raw=true" title="Xilinx Inc"/>
							</a>
						</div>
					</div>

				</div>
			</div>
			</nav></header></noindex></div>
		
	
</div>

    
</div>
</div>

<div class="calloutBanner parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16"><div class="callout-banner">
    Xilinx is now a part of <a target="_blank" href="https://www.amd.com/en/corporate/xilinx-acquisition">AMD</a> |  <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Learn More</a>
</div>
</div>
				<div class="parsys aem-GridColumn--xxxlarge--none aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
						<div class="container-fluid">
							<div class="row">
							<div class="col-xs-12">
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Vitis Vision Library
          

          
          </a>

          
            
            
              <div class="version">
                2024.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

      
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
            
            
            
              
            
            
              <p class="caption"><span class="caption-text">Vitis Vision Library User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#getting-started-with-vitis-vision">Getting Started with Vitis Vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#using-the-vitis-vision-library">Using the Vitis Vision Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#getting-started-with-hls">Getting Started with HLS</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#migrating-the-hls-video-library-to-vitis-vision">Migrating the HLS Video Library to Vitis vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#design-examples-using-the-vitis-vision-library">Design Examples Using the Vitis Vision Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#id7">Defect Detection Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#isp-all-in-one-adas-pipeline">ISP all_in_one_adas Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html#isp-all-in-one-pipeline">ISP all_in_one Pipeline:</a></li>
</ul>
<p class="caption"><span class="caption-text">Vitis Vision AIE Library User Guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-features">Basic Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vitis-vision-aie-library-contents">Vitis Vision AIE Library Contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#getting-started-with-vitis-vision-aie">Getting Started with Vitis Vision AIE</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#aie-prerequisites">AIE Prerequisites</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#vitis-aie-design-methodology">Vitis AIE Design Methodology</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prepare-the-kernels">Prepare the Kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-flow-graph-construction">Data Flow Graph Construction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-platform-ports">Setting up Platform Ports</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#plio">PLIO</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gmio">GMIO</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#host-code-integration">Host Code Integration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#x86simulation-aie-simulation">x86Simulation / AIE Simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hw-emulation-hw-run">HW Emulation / HW Run</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#xfcvdatamovers">xfcvDataMovers</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#evaluating-the-functionality">Evaluating the Functionality</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#x86-simulation">x86 Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aie-simulation">AIE Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hw-emulation">HW Emulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-on-hw">Testing on HW</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#design-example-using-vitis-vision-aie-library">Design example Using Vitis Vision AIE Library</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#adf-graph">ADF Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="#platform-ports">Platform Ports</a></li>
<li class="toctree-l2"><a class="reference internal" href="#host-code">Host code</a></li>
<li class="toctree-l2"><a class="reference internal" href="#makefile">Makefile</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Vitis Vision Library API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api-reference.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-reference.html#vitis-vision-library-functions">Vitis Vision Library Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-reference.html#id45">Degamma</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-reference.html#lens-shading-correction">Lens Shading Correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-reference.html#rgbir-to-standard-bayer-format">RGBIR  to Standard Bayer Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-reference.html#id83">Rotate</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-reference.html#tvl1-optical-flow">TVL1 Optical Flow</a></li>
</ul>
<p class="caption"><span class="caption-text">Vitis Vision AIE Library API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api-reference-aie.html">Vitis Vision AIE Library API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Benchmark</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Benchmark.html">Benchmark</a></li>
</ul>
<p class="caption"><span class="caption-text">Release Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="releasenotesxfopencv.html">Release Notes</a></li>
</ul>

            
			
			<p class="caption"><span class="caption-text">This Page</span></p>
				<ul class="current">
				  <li class="toctree-l1"><a href="_sources/overview-aie.rst.txt"
						rel="nofollow">Show Source</a></li>
				</ul>
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Vitis Vision Library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Overview</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/overview-aie.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="overview">
<span id="overview-aie"></span><h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<p>AMD Vitis™ Vision library added some functions which are implemented on the AI Engine of AMD Versal Adaptive SoC devices and validated on <a href="#id10"><span class="problematic" id="id11">`VEK280`_</span></a> board. These implementations exploit the VLIW, SIMD vector processing capabilities of <a class="reference external" href="https://docs.amd.com/r/en-US/ug1076-ai-engine-environment/Overview">AI Engines</a>.</p>
<div class="section" id="basic-features">
<span id="basic-features-aie"></span><h2>Basic Features<a class="headerlink" href="#basic-features" title="Permalink to this headline">¶</a></h2>
<p>To process high resolution images, the xfcvDataMovers component is provided. This divides the image into tiled units and uses efficient data-movers to manage the transfer of tiled units to and from AI Engine cores. You can find more information on the types of data-movers and their usage, in the <a class="reference internal" href="#aie-prerequisites"><span class="std std-ref">Getting Started with Vitis Vision AIEngine Library Functions</span></a> section.</p>
</div>
<div class="section" id="vitis-vision-aie-library-contents">
<h2>Vitis Vision AIE Library Contents<a class="headerlink" href="#vitis-vision-aie-library-contents" title="Permalink to this headline">¶</a></h2>
<p>Vitis Vision AIEngine files are organized into the following directories:</p>
<table border="1" class="docutils" id="id6">
<caption><span class="caption-text">Table: Vitis Vision AIE Library Contents</span><a class="headerlink" href="#id6" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="38%" />
<col width="62%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Folder</th>
<th class="head">Details</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>L1/include/aie-ml/imgproc</td>
<td>contains header files of Vision AIEngine™ functions</td>
</tr>
<tr class="row-odd"><td>L1/include/aie/common</td>
<td>contains header files of data-movers and other utility functions</td>
</tr>
<tr class="row-even"><td>L1/lib/sw</td>
<td>contains the data-movers library object files</td>
</tr>
<tr class="row-odd"><td>L2/tests/aie-ml</td>
<td>contains the ADF graph code and host-code using data-movers and Vision AIEngine™ functions
from L1/include/aie-ml</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="getting-started-with-vitis-vision-aie">
<h1>Getting Started with Vitis Vision AIE<a class="headerlink" href="#getting-started-with-vitis-vision-aie" title="Permalink to this headline">¶</a></h1>
<p>Describes the methodology to accelerate <a class="reference internal" href="api-reference-aie.html#aie-library-functions"><span class="std std-ref">Vitis Vision AIE library functions</span></a> on Versal adaptive SoCs. This includes creation of Adaptive Data Flow (ADF) Graphs, setting up a virtual platform, and writing corresponding host code. It also covers various verification models including <a class="reference internal" href="#x86-simulation"><span class="std std-ref">x86 based simuation</span></a>, <a class="reference internal" href="#aie-simulation"><span class="std std-ref">cycle accurate AIE simulation</span></a>, <a class="reference internal" href="#hw-emulation"><span class="std std-ref">HW emulation</span></a> and <a class="reference internal" href="#hw-testing"><span class="std std-ref">HW run</span></a> methods using a suitable <a class="reference internal" href="#aie-makefile"><span class="std std-ref">Makefile</span></a>.</p>
<div class="section" id="aie-prerequisites">
<span id="id1"></span><h2>AIE Prerequisites<a class="headerlink" href="#aie-prerequisites" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Valid installation of AMD Vitis™ version 2024.1 or later, and the
corresponding licenses.</li>
<li>Install the Vitis Vision libraries, if you intend to use libraries
compiled differently than what is provided in Vitis.</li>
<li>Install the card for which the platform is supported in Vitis 2024.1 or
later.</li>
<li>If targeting an embedded platform, set up the evaluation board.</li>
<li>Xilinx Runtime (XRT) must be installed. XRT provides software
interface to AMD FPGAs.</li>
<li>Install/compile OpenCV libraries (with compatible <code class="docutils literal notranslate"><span class="pre">libjpeg.so</span></code>).
An appropriate version (<code class="docutils literal notranslate"><span class="pre">X86/aarch32/aarch64</span></code>) of the compiler must be used based
on the available processor for the target board.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All <a class="reference internal" href="api-reference-aie.html#aie-library-functions"><span class="std std-ref">Vitis Vision AIE library functions</span></a> were tested against OpenCV version - 4.4.0</p>
</div>
</div>
</div>
<div class="section" id="vitis-aie-design-methodology">
<h1>Vitis AIE Design Methodology<a class="headerlink" href="#vitis-aie-design-methodology" title="Permalink to this headline">¶</a></h1>
<p>Following are critical components in making a kernel work on a platform using the AMD Vitis™ software platform:</p>
<ol class="arabic simple">
<li>Prepare the Kernels</li>
<li>Data Flow Graph construction</li>
<li>Setting up platform ports</li>
<li>Host code integration</li>
<li>Makefile to compile the kernel for x86 simulation / aie simulation / hw-emulation / hw runs</li>
</ol>
<div class="section" id="prepare-the-kernels">
<h2>Prepare the Kernels<a class="headerlink" href="#prepare-the-kernels" title="Permalink to this headline">¶</a></h2>
<p>Kernels are computation functions that form the fundamental building blocks of the data flow graph specifications. Kernels are declared as ordinary C/C++ functions that return void and can use special data types as arguments (discussed in <a href="#id12"><span class="problematic" id="id13">`Window and Streaming Data API`_</span></a>). Each kernel should be defined in its own source file. This organization is recommended for reusable and faster compilation. Furthermore, the kernel source files should include all relevant header files to allow for independent compilation. It is recommended that a header file (<code class="docutils literal notranslate"><span class="pre">kernels.h</span></code> in this documentation) should declare the function prototypes for all kernels used in a graph. An example is shown below.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#ifndef _KERNELS_16B_H_</span>
<span class="c1">#define _KERNELS_16B_H_</span>

<span class="c1">#include &lt;adf/stream/types.h&gt;</span>
<span class="c1">#include &lt;adf/window/types.h&gt;</span>
<span class="c1">#include &lt;stdint.h&gt;</span>
<span class="c1">#include &lt;stdio.h&gt;</span>
<span class="c1">#include &lt;stdlib.h&gt;</span>

<span class="c1">#define PARALLEL_FACTOR_16b 16 // Parallelization factor for 16b operations (16x mults)</span>
<span class="c1">#define SRS_SHIFT 10           // SRS shift used can be increased if input data likewise adjusted)</span>

<span class="n">void</span> <span class="n">filter2D</span><span class="p">(</span><span class="n">adf</span><span class="p">::</span><span class="n">input_buffer</span><span class="o">&lt;</span><span class="n">int16</span><span class="o">&gt;&amp;</span> <span class="nb">input</span><span class="p">,</span> <span class="n">const</span> <span class="n">int16_t</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">coeff</span><span class="p">)[</span><span class="mi">16</span><span class="p">],</span> <span class="n">adf</span><span class="p">::</span><span class="n">output_buffer</span><span class="o">&lt;</span><span class="n">int16</span><span class="o">&gt;&amp;</span> <span class="n">output</span><span class="p">);</span>

<span class="c1">#endif</span>
</pre></div>
</div>
<p><a class="reference internal" href="api-reference-aie.html#aie-library-functions"><span class="std std-ref">Vitis Vision AIE library functions</span></a> packaged with Vitis Vision AIE library are pre optimized vector implementations for various computer vision tasks. These functions can be directly included in user kernel (as shown in example below).</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;imgproc/xf_filter2d_16b_aieml.hpp&quot;</span>
<span class="c1">#include &quot;kernels.h&quot;</span>

<span class="n">void</span> <span class="n">filter2D</span><span class="p">(</span><span class="n">adf</span><span class="p">::</span><span class="n">input_buffer</span><span class="o">&lt;</span><span class="n">int16</span><span class="o">&gt;&amp;</span> <span class="nb">input</span><span class="p">,</span> <span class="n">const</span> <span class="n">int16_t</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">coeff</span><span class="p">)[</span><span class="mi">16</span><span class="p">],</span> <span class="n">adf</span><span class="p">::</span><span class="n">output_buffer</span><span class="o">&lt;</span><span class="n">int16</span><span class="o">&gt;&amp;</span> <span class="n">output</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">xf</span><span class="p">::</span><span class="n">cv</span><span class="p">::</span><span class="n">aie</span><span class="p">::</span><span class="n">filter2D</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">output</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="data-flow-graph-construction">
<h2>Data Flow Graph Construction<a class="headerlink" href="#data-flow-graph-construction" title="Permalink to this headline">¶</a></h2>
<p>Once AIE kernels have been prepared, next step is to create a Data Flow Graph class which defines the top level ports, <a class="reference external" href="https://docs.amd.com/r/en-US/ug1079-ai-engine-kernel-coding/Run-Time-Graph-Control-API">Run time parameters</a>, connectivity, constraints etc. This consists of the following steps:</p>
<ol class="arabic">
<li><p class="first">Create <code class="docutils literal notranslate"><span class="pre">graph.h</span></code> and include Adaptive Data Flow (ADF) header file (<code class="docutils literal notranslate"><span class="pre">adf.h</span></code>). Also include header file with kernel function prototypes (<code class="docutils literal notranslate"><span class="pre">kernel.h</span></code>)</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;adf.h&gt;</span>
<span class="c1">#include &quot;kernels.h&quot;</span>
</pre></div>
</div>
</li>
<li><p class="first">Define your graph class by using the objects which are defined in the adf name space. All user graphs are derived from the class graph.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">include</span> <span class="o">&lt;</span><span class="n">adf</span><span class="o">.</span><span class="n">h</span><span class="o">&gt;</span>
<span class="c1">#include &quot;kernels.h&quot;</span>

<span class="n">using</span> <span class="n">namespace</span> <span class="n">adf</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">myGraph</span> <span class="p">:</span> <span class="n">public</span> <span class="n">graph</span> <span class="p">{</span>
<span class="n">private</span><span class="p">:</span>
    <span class="n">kernel</span> <span class="n">k1</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p class="first">Add top level ports to graph. These ports will be responsible to data transfers to / from the kernels.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;adf.h&gt;</span>
<span class="c1">#include &quot;kernels.h&quot;</span>

<span class="n">using</span> <span class="n">namespace</span> <span class="n">adf</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">simpleGraph</span> <span class="p">:</span> <span class="n">public</span> <span class="n">graph</span> <span class="p">{</span>
<span class="n">private</span><span class="p">:</span>
    <span class="n">kernel</span> <span class="n">k1</span><span class="p">;</span>

<span class="n">public</span><span class="p">:</span>
    <span class="n">port</span><span class="o">&lt;</span><span class="nb">input</span><span class="o">&gt;</span> <span class="n">inptr</span><span class="p">;</span>
    <span class="n">port</span><span class="o">&lt;</span><span class="n">output</span><span class="o">&gt;</span> <span class="n">outptr</span><span class="p">;</span>
    <span class="n">port</span><span class="o">&lt;</span><span class="nb">input</span><span class="o">&gt;</span> <span class="n">kernelCoefficients</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p class="first">Specify connections of top level ports to kernels. Primary connections type are <a href="#id14"><span class="problematic" id="id15">`Window`_</span></a>, <a class="reference external" href="https://docs.amd.com/r/en-US/ug1079-ai-engine-kernel-coding/Buffer-vs.-Stream-in-Data-Communication">Stream</a>, <a class="reference external" href="https://docs.amd.com/r/en-US/ug1079-ai-engine-kernel-coding/Run-Time-Graph-Control-API">Run time parameters</a>. Below is example code specifying connectivity.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">myGraph</span> <span class="p">:</span> <span class="n">public</span> <span class="n">adf</span><span class="p">::</span><span class="n">graph</span> <span class="p">{</span>
<span class="n">private</span><span class="p">:</span>
    <span class="n">kernel</span> <span class="n">k1</span><span class="p">;</span>
<span class="n">public</span><span class="p">:</span>
    <span class="n">port</span><span class="o">&lt;</span><span class="nb">input</span><span class="o">&gt;</span> <span class="n">inptr</span><span class="p">;</span>
    <span class="n">port</span><span class="o">&lt;</span><span class="n">output</span><span class="o">&gt;</span> <span class="n">outptr</span><span class="p">;</span>
    <span class="n">port</span><span class="o">&lt;</span><span class="nb">input</span><span class="o">&gt;</span> <span class="n">kernelCoefficients</span><span class="p">;</span>

    <span class="n">myGraph</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">k1</span> <span class="o">=</span> <span class="n">kernel</span><span class="p">::</span><span class="n">create</span><span class="p">(</span><span class="n">filter2D</span><span class="p">);</span>
        <span class="n">adf</span><span class="p">::</span><span class="n">connect</span><span class="p">(</span><span class="n">inptr</span><span class="p">,</span> <span class="n">k1</span><span class="o">.</span><span class="ow">in</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="n">adf</span><span class="p">::</span><span class="n">connect</span><span class="o">&lt;</span><span class="n">parameter</span><span class="o">&gt;</span><span class="p">(</span><span class="n">kernelCoefficients</span><span class="p">,</span> <span class="k">async</span><span class="p">(</span><span class="n">k1</span><span class="o">.</span><span class="ow">in</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
        <span class="n">adf</span><span class="p">::</span><span class="n">connect</span><span class="p">(</span><span class="n">k1</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">outptr</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
<li><p class="first">Specify the source file location and other constraints for each kernel.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">myGraph</span> <span class="p">:</span> <span class="n">public</span> <span class="n">adf</span><span class="p">::</span><span class="n">graph</span> <span class="p">{</span>
<span class="n">private</span><span class="p">:</span>
    <span class="n">kernel</span> <span class="n">k1</span><span class="p">;</span>
<span class="n">public</span><span class="p">:</span>
    <span class="n">port</span><span class="o">&lt;</span><span class="nb">input</span><span class="o">&gt;</span> <span class="n">inptr</span><span class="p">;</span>
    <span class="n">port</span><span class="o">&lt;</span><span class="n">output</span><span class="o">&gt;</span> <span class="n">outptr</span><span class="p">;</span>
    <span class="n">port</span><span class="o">&lt;</span><span class="nb">input</span><span class="o">&gt;</span> <span class="n">kernelCoefficients</span><span class="p">;</span>

    <span class="n">myGraph</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">k1</span> <span class="o">=</span> <span class="n">kernel</span><span class="p">::</span><span class="n">create</span><span class="p">(</span><span class="n">filter2D</span><span class="p">);</span>
        <span class="n">adf</span><span class="p">::</span><span class="n">connect</span><span class="p">(</span><span class="n">inptr</span><span class="p">,</span> <span class="n">k1</span><span class="o">.</span><span class="ow">in</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
        <span class="n">adf</span><span class="p">::</span><span class="n">connect</span><span class="o">&lt;</span><span class="n">parameter</span><span class="o">&gt;</span><span class="p">(</span><span class="n">kernelCoefficients</span><span class="p">,</span> <span class="k">async</span><span class="p">(</span><span class="n">k1</span><span class="o">.</span><span class="ow">in</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
        <span class="n">adf</span><span class="p">::</span><span class="n">connect</span><span class="p">(</span><span class="n">k1</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">outptr</span><span class="p">);</span>
        <span class="n">source</span><span class="p">(</span><span class="n">k1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;xf_filter2d.cc&quot;</span><span class="p">;</span>
        <span class="o">//</span> <span class="n">Initial</span> <span class="n">mapping</span>
        <span class="n">runtime</span><span class="o">&lt;</span><span class="n">ratio</span><span class="o">&gt;</span><span class="p">(</span><span class="n">k1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="setting-up-platform-ports">
<h2>Setting up Platform Ports<a class="headerlink" href="#setting-up-platform-ports" title="Permalink to this headline">¶</a></h2>
<p>The next step is to create a <code class="docutils literal notranslate"><span class="pre">graph.cpp</span></code> file with platform ports and virtual platform specification. A virtual platform specification helps to connect the data flow graph written with external I/O mechanisms specific to the chosen target for testing or eventual deployment.</p>
<p>There are two types of platform ports attributes which describe how data is transferred to / from AIE cores.</p>
<div class="section" id="plio">
<span id="plio-aie"></span><h3>PLIO<a class="headerlink" href="#plio" title="Permalink to this headline">¶</a></h3>
<p>A PLIO port attribute is used to make external stream connections that cross the AI Engine to programmable logic (PL) boundary. The following example shows how the PLIO attributes shown in the previous table can be used in a program to read input data from a file or write output data to a file. The PLIO width and frequency of the PLIO port are also provided in the PLIO constructor. For more details refer to <a class="reference external" href="https://docs.amd.com/r/en-US/ug1079-ai-engine-kernel-coding/Configuring-input_plio/output_plio">PLIO Attributes</a>.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">Virtual</span> <span class="n">platform</span> <span class="n">ports</span>
<span class="n">inptr</span> <span class="o">=</span> <span class="n">input_plio</span><span class="p">::</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;DataIn1&quot;</span><span class="p">,</span> <span class="n">adf</span><span class="p">::</span><span class="n">plio_128_bits</span><span class="p">,</span> <span class="s2">&quot;data/input_128x16.txt&quot;</span><span class="p">);</span>
<span class="n">outptr</span> <span class="o">=</span> <span class="n">output_plio</span><span class="p">::</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;DataOut1&quot;</span><span class="p">,</span> <span class="n">adf</span><span class="p">::</span><span class="n">plio_128_bits</span><span class="p">,</span> <span class="s2">&quot;data/output.txt&quot;</span><span class="p">);</span>

<span class="o">//</span><span class="n">Virtual</span> <span class="n">platform</span> <span class="n">connectivity</span>
<span class="n">connect</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">inptr</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k1</span><span class="o">.</span><span class="ow">in</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">connect</span><span class="o">&lt;</span><span class="n">parameter</span><span class="o">&gt;</span><span class="p">(</span><span class="n">kernelCoefficients</span><span class="p">,</span> <span class="k">async</span><span class="p">(</span><span class="n">k1</span><span class="o">.</span><span class="ow">in</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
<span class="n">connect</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">k1</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">outptr</span><span class="o">.</span><span class="ow">in</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="section" id="gmio">
<span id="gmio-aie"></span><h3>GMIO<a class="headerlink" href="#gmio" title="Permalink to this headline">¶</a></h3>
<p>A GMIO port attribute is used to make external memory-mapped connections to or from the global memory. These connections are made between an AI Engine graph and the logical global memory ports of a hardware platform design. For more details please refer <a class="reference external" href="https://docs.amd.com/r/en-US/ug1079-ai-engine-kernel-coding/Configuring-input_gmio/output_gmio">GMIO Attributes</a>.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GMIO</span> <span class="n">gmioIn1</span><span class="p">(</span><span class="s2">&quot;gmioIn1&quot;</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
<span class="n">GMIO</span> <span class="n">gmioOut</span><span class="p">(</span><span class="s2">&quot;gmioOut&quot;</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>

<span class="n">connect</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">inptr</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k1</span><span class="o">.</span><span class="ow">in</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">connect</span><span class="o">&lt;</span><span class="n">parameter</span><span class="o">&gt;</span><span class="p">(</span><span class="n">kernelCoefficients</span><span class="p">,</span> <span class="k">async</span><span class="p">(</span><span class="n">k1</span><span class="o">.</span><span class="ow">in</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
<span class="n">connect</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">k1</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">outptr</span><span class="o">.</span><span class="ow">in</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="host-code-integration">
<h2>Host Code Integration<a class="headerlink" href="#host-code-integration" title="Permalink to this headline">¶</a></h2>
<p>Depending on the functional verification model used, the top level application can be written using on of two ways.</p>
<div class="section" id="x86simulation-aie-simulation">
<h3>x86Simulation / AIE Simulation<a class="headerlink" href="#x86simulation-aie-simulation" title="Permalink to this headline">¶</a></h3>
<p>In this mode the top level application can be written inside <code class="docutils literal notranslate"><span class="pre">graph.cpp</span></code> file. The application contains an instance of ADF graph and a main function within which API’s are called to initialize, run, and end the graph. It may also have additional API’s to update <a class="reference external" href="https://docs.amd.com/r/en-US/ug1079-ai-engine-kernel-coding/Run-Time-Graph-Control-API">Run time parameters</a>. Additionally for hw emulation / hw run modes, the ‘<code class="docutils literal notranslate"><span class="pre">main()</span></code>’ function can be guarded by a <code class="docutils literal notranslate"><span class="pre">#ifdef</span></code> to ensure graph is only initialized once, or run only once. The following example code is the simple application defined in <a class="reference external" href="https://docs.amd.com/r/en-US/ug1079-ai-engine-kernel-coding/Creating-a-Data-Flow-Graph-Including-Kernels">Creating a Data Flow Graph (Including Kernels)</a> with the additional guard macro __AIESIM__ and __X86SIM__.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Virtual</span> <span class="n">platform</span> <span class="n">ports</span>
<span class="n">inptr</span> <span class="o">=</span> <span class="n">input_plio</span><span class="p">::</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;DataIn1&quot;</span><span class="p">,</span> <span class="n">adf</span><span class="p">::</span><span class="n">plio_128_bits</span><span class="p">,</span> <span class="s2">&quot;data/input_128x16.txt&quot;</span><span class="p">);</span>
<span class="n">outptr</span> <span class="o">=</span> <span class="n">output_plio</span><span class="p">::</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;DataOut1&quot;</span><span class="p">,</span> <span class="n">adf</span><span class="p">::</span><span class="n">plio_128_bits</span><span class="p">,</span> <span class="s2">&quot;data/output.txt&quot;</span><span class="p">);</span>

<span class="o">//</span> <span class="n">Virtual</span> <span class="n">platform</span> <span class="n">connectivity</span>
<span class="n">connect</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">inptr</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k1</span><span class="o">.</span><span class="ow">in</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">connect</span><span class="o">&lt;</span><span class="n">parameter</span><span class="o">&gt;</span><span class="p">(</span><span class="n">kernelCoefficients</span><span class="p">,</span> <span class="k">async</span><span class="p">(</span><span class="n">k1</span><span class="o">.</span><span class="ow">in</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
<span class="n">connect</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">k1</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">outptr</span><span class="o">.</span><span class="ow">in</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>

<span class="c1">#define SRS_SHIFT 10</span>
<span class="nb">float</span> <span class="n">kData</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.0625</span><span class="p">,</span> <span class="mf">0.1250</span><span class="p">,</span> <span class="mf">0.0625</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">,</span> <span class="mf">0.0625</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">,</span> <span class="mf">0.0625</span><span class="p">};</span>


<span class="c1">#if defined(__AIESIM__) || defined(__X86SIM__)</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">(</span><span class="nb">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">filter_graph</span><span class="o">.</span><span class="n">init</span><span class="p">();</span>
    <span class="n">filter_graph</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">filter_graph</span><span class="o">.</span><span class="n">kernelCoefficients</span><span class="p">,</span> <span class="n">float2fixed_coeff</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="o">&gt;</span><span class="p">(</span><span class="n">kData</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">(),</span> <span class="mi">16</span><span class="p">);</span>
    <span class="n">filter_graph</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">filter_graph</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">#endif</span>
</pre></div>
</div>
<p>In case GMIO based ports are used.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#if defined(__AIESIM__) || defined(__X86SIM__)</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">(</span><span class="nb">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="o">...</span>
    <span class="n">int16_t</span><span class="o">*</span> <span class="n">inputData</span> <span class="o">=</span> <span class="p">(</span><span class="n">int16_t</span><span class="o">*</span><span class="p">)</span><span class="n">GMIO</span><span class="p">::</span><span class="n">malloc</span><span class="p">(</span><span class="n">BLOCK_SIZE_in_Bytes</span><span class="p">);</span>
    <span class="n">int16_t</span><span class="o">*</span> <span class="n">outputData</span> <span class="o">=</span> <span class="p">(</span><span class="n">int16_t</span><span class="o">*</span><span class="p">)</span><span class="n">GMIO</span><span class="p">::</span><span class="n">malloc</span><span class="p">(</span><span class="n">BLOCK_SIZE_in_Bytes</span><span class="p">);</span>

    <span class="o">//</span><span class="n">Prepare</span> <span class="nb">input</span> <span class="n">data</span>
    <span class="o">...</span>
    <span class="o">...</span>

    <span class="n">filter_graph</span><span class="o">.</span><span class="n">init</span><span class="p">();</span>
    <span class="n">filter_graph</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">filter_graph</span><span class="o">.</span><span class="n">kernelCoefficients</span><span class="p">,</span> <span class="n">float2fixed_coeff</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="o">&gt;</span><span class="p">(</span><span class="n">kData</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">(),</span> <span class="mi">16</span><span class="p">);</span>

    <span class="n">filter_graph</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

    <span class="o">//</span><span class="n">GMIO</span> <span class="n">Data</span> <span class="n">transfer</span> <span class="n">calls</span>
    <span class="n">gmioIn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">gm2aie_nb</span><span class="p">(</span><span class="n">inputData</span><span class="p">,</span> <span class="n">BLOCK_SIZE_in_Bytes</span><span class="p">);</span>
    <span class="n">gmioOut</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">aie2gm_nb</span><span class="p">(</span><span class="n">outputData</span><span class="p">,</span> <span class="n">BLOCK_SIZE_in_Bytes</span><span class="p">);</span>
    <span class="n">gmioOut</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">wait</span><span class="p">();</span>

    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;after grph wait</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">filter_graph</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>

    <span class="o">...</span>
<span class="p">}</span>
<span class="c1">#endif</span>
</pre></div>
</div>
</div>
<div class="section" id="hw-emulation-hw-run">
<h3>HW Emulation / HW Run<a class="headerlink" href="#hw-emulation-hw-run" title="Permalink to this headline">¶</a></h3>
<p>For x86Simulation, the AIE simulation and top level application had simple ADF API calls to initialize / run / end the graph. However, for actual AI Engine graph applications the host code must do much more than those simple tasks. The top-level PS application running on the Cortex®-A72 controls the graph and PL kernels: manage data inputs to the graph, handle data outputs from the graph, and control any PL kernels working with the graph. Sample code is illustrated below.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span><span class="o">//</span> <span class="n">Open</span> <span class="n">device</span><span class="p">,</span> <span class="n">load</span> <span class="n">xclbin</span><span class="p">,</span> <span class="ow">and</span> <span class="n">get</span> <span class="n">uuid</span>

<span class="n">xF</span><span class="p">::</span><span class="n">deviceInit</span><span class="p">(</span><span class="n">xclBinName</span><span class="p">);</span>

<span class="mf">2.</span> <span class="n">Allocate</span> <span class="n">output</span> <span class="n">buffer</span> <span class="n">objects</span> <span class="ow">and</span> <span class="nb">map</span> <span class="n">to</span> <span class="n">host</span> <span class="n">memory</span>

<span class="n">void</span><span class="o">*</span> <span class="n">srcData</span> <span class="o">=</span> <span class="n">nullptr</span><span class="p">;</span>
<span class="n">xrt</span><span class="p">::</span><span class="n">bo</span> <span class="n">dst_hndl</span> <span class="o">=</span> <span class="n">xrt</span><span class="p">::</span><span class="n">bo</span><span class="p">(</span><span class="n">xF</span><span class="p">::</span><span class="n">gpDhdl</span><span class="p">,</span> <span class="p">(</span><span class="n">srcImageR</span><span class="o">.</span><span class="n">total</span><span class="p">()</span> <span class="o">*</span> <span class="n">srcImageR</span><span class="o">.</span><span class="n">elemSize</span><span class="p">()),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">srcData</span> <span class="o">=</span> <span class="n">src_hndl</span><span class="o">.</span><span class="n">map</span><span class="p">();</span>
<span class="n">memcpy</span><span class="p">(</span><span class="n">srcData</span><span class="p">,</span> <span class="n">srcImageR</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">srcImageR</span><span class="o">.</span><span class="n">total</span><span class="p">()</span> <span class="o">*</span> <span class="n">srcImageR</span><span class="o">.</span><span class="n">elemSize</span><span class="p">()));</span>

<span class="mf">3.</span> <span class="n">Get</span> <span class="n">kernel</span> <span class="ow">and</span> <span class="n">run</span> <span class="n">handles</span><span class="p">,</span> <span class="nb">set</span> <span class="n">arguments</span> <span class="k">for</span> <span class="n">kernel</span><span class="p">,</span> <span class="ow">and</span> <span class="n">launch</span> <span class="n">kernel</span><span class="o">.</span>
<span class="n">xrt</span><span class="p">::</span><span class="n">kernel</span> <span class="n">s2mm_khdl</span> <span class="o">=</span> <span class="n">xrt</span><span class="p">::</span><span class="n">kernel</span><span class="p">(</span><span class="n">xF</span><span class="p">::</span><span class="n">gpDhdl</span><span class="p">,</span> <span class="n">xF</span><span class="p">::</span><span class="n">xclbin_uuid</span><span class="p">,</span> <span class="s2">&quot;s2mm&quot;</span><span class="p">);</span> <span class="o">//</span> <span class="n">Open</span> <span class="n">kernel</span> <span class="n">handle</span>
<span class="n">xrt</span><span class="p">::</span><span class="n">run</span> <span class="n">s2mm_rhdl</span> <span class="o">=</span> <span class="n">s2mm_khdl</span><span class="p">(</span><span class="n">out_bohdl</span><span class="p">,</span> <span class="n">nullptr</span><span class="p">,</span> <span class="n">OUTPUT_SIZE</span><span class="p">);</span> <span class="o">//</span> <span class="nb">set</span> <span class="n">kernel</span> <span class="n">arg</span>

<span class="o">//</span> <span class="n">Update</span> <span class="n">graph</span> <span class="n">parameters</span> <span class="p">(</span><span class="n">RTP</span><span class="p">)</span> <span class="ow">and</span> <span class="n">so</span> <span class="n">on</span>
<span class="n">auto</span> <span class="n">gHndl</span> <span class="o">=</span> <span class="n">xrt</span><span class="p">::</span><span class="n">graph</span><span class="p">(</span><span class="n">xF</span><span class="p">::</span><span class="n">gpDhdl</span><span class="p">,</span> <span class="n">xF</span><span class="p">::</span><span class="n">xclbin_uuid</span><span class="p">,</span> <span class="s2">&quot;filter_graph&quot;</span><span class="p">);</span>
<span class="n">gHndl</span><span class="o">.</span><span class="n">reset</span><span class="p">();</span>
<span class="n">gHndl</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;filter_graph.k1.in[1]&quot;</span><span class="p">,</span> <span class="n">float2fixed_coeff</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="o">&gt;</span><span class="p">(</span><span class="n">kData</span><span class="p">));</span>
<span class="n">gHndl</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">gHndl</span><span class="o">.</span><span class="n">wait</span><span class="p">();</span>

<span class="mf">4.</span> <span class="n">Wait</span> <span class="k">for</span> <span class="n">kernel</span> <span class="n">completion</span><span class="o">.</span>
<span class="n">s2mm_rhdl</span><span class="o">.</span><span class="n">wait</span><span class="p">();</span>

<span class="mf">5.</span> <span class="n">Sync</span> <span class="n">output</span> <span class="n">device</span> <span class="n">buffer</span> <span class="n">objects</span> <span class="n">to</span> <span class="n">host</span> <span class="n">memory</span><span class="o">.</span>

<span class="n">dst_hndl</span><span class="o">.</span><span class="n">sync</span><span class="p">(</span><span class="n">XCL_BO_SYNC_BO_FROM_DEVICE</span><span class="p">);</span>

<span class="o">//</span><span class="mf">6.</span> <span class="n">post</span><span class="o">-</span><span class="n">processing</span> <span class="n">on</span> <span class="n">host</span> <span class="n">memory</span> <span class="o">-</span> <span class="s2">&quot;host_out</span>
</pre></div>
</div>
<p><a class="reference internal" href="api-reference-aie.html#aie-library-functions"><span class="std std-ref">Vitis Vision AIE library functions</span></a> provide optimal vector implementations of various computer vision algorithms. These functions are expected to process high resolution images. However because local memory in AIE core modules is limited, entire images can’t be fit into it. Also accessing DDR for reading / writing image data will be highly inefficient both for performance and power. To overcome this limitation, host code is expected to split the high resolution image into smaller tiles which fit in the AIE Engine local memory in ping-pong fashion. Splitting high resolution images into smaller tiles is a complex operation as it need to be aware of overlap regions and borders. Also the tile size is expected to be aligned with vectorization factor of the kernel.</p>
<p>To facilitate this the Vitis Vision Library provides data movers which perform smart tiling / stitching of high resolution images which can meet all the above requirements. There are two versions made available which can provide data movement capabilities both using PLIO and GMIO interfaces. A high-level class abstraction is provided with a simple API interface to facilitate data transfers. The class abstraction allows for seamless transition between the PLIO - GMIO methods of data transfers.</p>
<div class="section" id="xfcvdatamovers">
<span id="xfcvdatamovers-aie"></span><h4>xfcvDataMovers<a class="headerlink" href="#xfcvdatamovers" title="Permalink to this headline">¶</a></h4>
<p>The xfcvDataMovers class provides a high level API abstraction to initiate data transfer from the DDR to the AIE core and vice versa for hw-emulation / hw runs. Because each AIE core has limited local memory which is not sufficient to fit an entire high resolution image (input / output), each image needs to be partitioned into smaller tiles and then send to AIE core for computation. After computation the tiled image at output is stitched back to generate the high resolution image at the output. This process involves complex computation as tiling needs to ensure proper border handling and overlap processing in case of
convolution based kernels.</p>
<p>The xfcvDataMovers class object takes some simple, user provided parameters and provides a simple data transaction API where you do not have to consider the complexity. Moreover it provides a template parameter, using which, the application can switch from PL-based data movement to GMIO-based (and vice versa) seamlessly.</p>
<table border="1" class="colwidths-given docutils" id="id7">
<caption><span class="caption-text">Table. xfcvDataMovers Template Parameters</span><a class="headerlink" href="#id7" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Parameter</td>
<td>Description</td>
</tr>
<tr class="row-even"><td>KIND</td>
<td>Type of object TILER / STITCHER</td>
</tr>
<tr class="row-odd"><td>DATA_TYPE</td>
<td>Data type of AIE core kernel input or output</td>
</tr>
<tr class="row-even"><td>TILE_HEIGHT_MAX</td>
<td>Maximum tile height</td>
</tr>
<tr class="row-odd"><td>TILE_WIDTH_MAX</td>
<td>Maximum tile width</td>
</tr>
<tr class="row-even"><td>AIE_VECTORIZATION_FACTOR</td>
<td>AIE core vectorization factor</td>
</tr>
<tr class="row-odd"><td>CORES</td>
<td>Number of AIE cores to be used</td>
</tr>
<tr class="row-even"><td>PL_AXI_BITWIDTH</td>
<td>For PL based data movers. It is the data width for AXI transfers between DDR - PL</td>
</tr>
<tr class="row-odd"><td>USE_GMIO</td>
<td>Set to true to use GMIO based data transfer</td>
</tr>
</tbody>
</table>
<table border="1" class="colwidths-given docutils" id="id8">
<caption><span class="caption-text">Table. xfcvDataMovers constructor parameters</span><a class="headerlink" href="#id8" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Parameter</td>
<td>Description</td>
</tr>
<tr class="row-even"><td>overlapH</td>
<td>Horizontal overlap of the AIE core / pipeline</td>
</tr>
<tr class="row-odd"><td>overlapV</td>
<td>Vertical overlap of the AIE core / pipeline</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Horizontal overlap and Vertical overlaps should be computed for the complete pipeline. For example if the pipeline has a single 3x3 2D filter then overlap sizes (both horizontal and vertical) will be 1. However in the case of two such filter operations which are back to back, the overlap size will be 2. Currently it is expected that users provide this input correctly.</p>
</div>
<p>The data transfer using the xfcvDataMovers class can be done in one of two ways:</p>
<ol class="arabic">
<li><p class="first">PLIO data movers</p>
<p>This is the default mode for xfcvDataMovers class operation. When this method is used, data is transferred using hardware Tiler / Stitcher IPs provided by AMD. The <a class="reference internal" href="#aie-makefile"><span class="std std-ref">Makefile</span></a> provided with design examples shipped with the library provide the locations of the .xo files for these IPs. It also shows how to incorporate them in the Vitis Build System. You need to create an object of xfcvDataMovers class per input / output image as shown in following code.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last"><strong>The implementations of Tiler and Stitcher for PLIO are provided as .xo files in the ‘L1/lib/hw’ folder. By using these files, you are agreeing to the terms and conditions specified in the LICENSE.txt file available in the same directory.</strong></p>
</div>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">overlapH</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="nb">int</span> <span class="n">overlapV</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">xF</span><span class="p">::</span><span class="n">xfcvDataMovers</span><span class="o">&lt;</span><span class="n">xF</span><span class="p">::</span><span class="n">TILER</span><span class="p">,</span> <span class="n">int16_t</span><span class="p">,</span> <span class="n">MAX_TILE_HEIGHT</span><span class="p">,</span> <span class="n">MAX_TILE_WIDTH</span><span class="p">,</span> <span class="n">VECTORIZATION_FACTOR</span><span class="o">&gt;</span> <span class="n">tiler</span><span class="p">(</span><span class="n">overlapH</span><span class="p">,</span> <span class="n">overlapV</span><span class="p">);</span>
<span class="n">xF</span><span class="p">::</span><span class="n">xfcvDataMovers</span><span class="o">&lt;</span><span class="n">xF</span><span class="p">::</span><span class="n">STITCHER</span><span class="p">,</span> <span class="n">int16_t</span><span class="p">,</span> <span class="n">MAX_TILE_HEIGHT</span><span class="p">,</span> <span class="n">MAX_TILE_WIDTH</span><span class="p">,</span> <span class="n">VECTORIZATION_FACTOR</span><span class="o">&gt;</span> <span class="n">stitcher</span><span class="p">;</span>
</pre></div>
</div>
<p>The choice of MAX_TILE_HEIGHT / MAX_TILE_WIDTH provides constraints on the image tile size which in turn governs local memory usage. The image tile size in bytes can be computed as follows.</p>
<p>Image tile size = (TILE_HEADER_SIZE_IN_BYTES + MAX_TILE_HEIGHT*MAX_TILE_WIDTH*sizeof(DATA_TYPE))</p>
<p>Here TILE_HEADER_SIZE_IN_BYTES is 128 bytes for the current version of Tiler / Stitcher. DATA_TYPE in above example is int16_t (2 bytes).o</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The current version of HW data movers have 8_16 configuration (i.e., an 8-bit image element data type on the host side and a 16-bit image element data type on the AIE kernel side). In future more such configurations will be provided (example: 8_8 / 16_16 etc.).</p>
</div>
<p>Tiler / Stitcher IPs use PL resources available on VCK boards. For 8_16 configuration, the following table illustrates resource utilization numbers for these IPs. The numbers correspond to a single instance of each IP.</p>
<table border="1" class="colwidths-given docutils" id="id9">
<caption><span class="caption-text">Table: Tiler / Stitcher Resource Utilization (8_16 config)</span><a class="headerlink" href="#id9" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="12%" />
<col width="18%" />
<col width="18%" />
<col width="18%" />
<col width="18%" />
<col width="18%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&#160;</th>
<th class="head">LUTs</th>
<th class="head">FFs</th>
<th class="head">BRAMs</th>
<th class="head">DSPs</th>
<th class="head">Fmax</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Tiler</strong></td>
<td>2761</td>
<td>3832</td>
<td>5</td>
<td>13</td>
<td>400 MHz</td>
</tr>
<tr class="row-odd"><td><strong>Stitcher</strong></td>
<td>2934</td>
<td>3988</td>
<td>5</td>
<td>7</td>
<td>400 MHz</td>
</tr>
<tr class="row-even"><td><strong>Total</strong></td>
<td>5695</td>
<td>7820</td>
<td>10</td>
<td>20</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">GMIO data movers</p>
<p>Transition to GMIO-based data movers can be achieved by using a specialized template implementation of the above class. All above constraints with regard to the image tile size calculation are valid here as well. Sample code is shown below.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xF</span><span class="p">::</span><span class="n">xfcvDataMovers</span><span class="o">&lt;</span><span class="n">xF</span><span class="p">::</span><span class="n">TILER</span><span class="p">,</span> <span class="n">int16_t</span><span class="p">,</span> <span class="n">MAX_TILE_HEIGHT</span><span class="p">,</span> <span class="n">MAX_TILE_WIDTH</span><span class="p">,</span> <span class="n">VECTORIZATION_FACTOR</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">true</span><span class="o">&gt;</span> <span class="n">tiler</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">xF</span><span class="p">::</span><span class="n">xfcvDataMovers</span><span class="o">&lt;</span><span class="n">xF</span><span class="p">::</span><span class="n">STITCHER</span><span class="p">,</span> <span class="n">int16_t</span><span class="p">,</span> <span class="n">MAX_TILE_HEIGHT</span><span class="p">,</span> <span class="n">MAX_TILE_WIDTH</span><span class="p">,</span> <span class="n">VECTORIZATION_FACTOR</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">true</span><span class="o">&gt;</span> <span class="n">stitcher</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The last template parameter is set  to true, implying GMIO specialization.</p>
</div>
</li>
</ol>
<p>Once the objects are constructed, simple API calls can be made to initiate the data transfers. Sample code is shown below.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">For</span> <span class="n">PLIO</span>
<span class="n">auto</span> <span class="n">tiles_sz</span> <span class="o">=</span> <span class="n">tiler</span><span class="o">.</span><span class="n">host2aie_nb</span><span class="p">(</span><span class="o">&amp;</span><span class="n">src_hndl</span><span class="p">,</span> <span class="n">srcImageR</span><span class="o">.</span><span class="n">size</span><span class="p">());</span>
<span class="n">stitcher</span><span class="o">.</span><span class="n">aie2host_nb</span><span class="p">(</span><span class="o">&amp;</span><span class="n">dst_hndl</span><span class="p">,</span> <span class="n">dst</span><span class="o">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">tiles_sz</span><span class="p">);</span>

<span class="o">//</span><span class="n">For</span> <span class="n">GMIO</span>
<span class="n">auto</span> <span class="n">tiles_sz</span> <span class="o">=</span> <span class="n">tiler</span><span class="o">.</span><span class="n">host2aie_nb</span><span class="p">(</span><span class="n">srcData</span><span class="o">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">srcImageR</span><span class="o">.</span><span class="n">size</span><span class="p">(),</span> <span class="p">{</span><span class="s2">&quot;gmioIn[0]&quot;</span><span class="p">});</span>
<span class="n">stitcher</span><span class="o">.</span><span class="n">aie2host_nb</span><span class="p">(</span><span class="n">dstData</span><span class="o">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">dst</span><span class="o">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">tiles_sz</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;gmioOut[0]&quot;</span><span class="p">});</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">GMIO data transfers take an additional argument which is the corresponding GMIO port to be used.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For GMIO-based transfers, there is a blocking method as well (host2aie(…) / aie2host(…)). For PLIO-based data transfers only non-blocking API calls are provided.</p>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">tile_sz</span></code>, you can run the graph the appropriate number of times.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">filter_graph_hndl</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">tiles_sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">tiles_sz</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</pre></div>
</div>
<p>After the runs are started, you need to wait for all transactions to complete.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">filter_graph_hndl</span><span class="o">.</span><span class="n">wait</span><span class="p">();</span>
<span class="n">tiler</span><span class="o">.</span><span class="n">wait</span><span class="p">();</span>
<span class="n">stitcher</span><span class="o">.</span><span class="n">wait</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="evaluating-the-functionality">
<h1>Evaluating the Functionality<a class="headerlink" href="#evaluating-the-functionality" title="Permalink to this headline">¶</a></h1>
<p>You can build the kernels and test the functionality through x86 simulation, cycle-accurate aie simulation, hw emulation, or hw run on the board. Use the following
commands to setup the basic environment:</p>
<div class="section" id="x86-simulation">
<span id="id2"></span><h2>x86 Simulation<a class="headerlink" href="#x86-simulation" title="Permalink to this headline">¶</a></h2>
<p>Refer to the <a class="reference external" href="https://docs.xilinx.com/r/en-US/ug1076-ai-engine-environment/Simulating-an-AI-Engine-Graph-Application">x86 Functional Simulation</a> section in Vitis Unified Software Development Platform 2024.1 Documentation. For host code development, refer to <a class="reference external" href="https://docs.xilinx.com/r/en-US/ug1076-ai-engine-environment/Programming-the-PS-Host-Application">Programming the PS Host Application</a> section</p>
</div>
<div class="section" id="aie-simulation">
<span id="id3"></span><h2>AIE Simulation<a class="headerlink" href="#aie-simulation" title="Permalink to this headline">¶</a></h2>
<p>Refer to the <a class="reference external" href="https://docs.xilinx.com/r/en-US/ug1076-ai-engine-environment/Simulating-an-AI-Engine-Graph-Application">AIE Simulation</a> section in Vitis Unified Software Development Platform 2024.1 Documentation. For host code development, refer to <a class="reference external" href="https://docs.xilinx.com/r/en-US/ug1076-ai-engine-environment/Programming-the-PS-Host-Application">Programming the PS Host Application</a> section.</p>
</div>
<div class="section" id="hw-emulation">
<span id="id5"></span><h2>HW Emulation<a class="headerlink" href="#hw-emulation" title="Permalink to this headline">¶</a></h2>
<p>Refer to the <a class="reference external" href="https://docs.xilinx.com/r/en-US/ug1076-ai-engine-environment/Programming-the-PS-Host-Application">Programming the PS Host Application</a> section in Vitis Unified Software Development Platform 2024.1 Documentation.</p>
</div>
<div class="section" id="testing-on-hw">
<span id="hw-testing"></span><h2>Testing on HW<a class="headerlink" href="#testing-on-hw" title="Permalink to this headline">¶</a></h2>
<p>After the build for hardware target completes, a <code class="docutils literal notranslate"><span class="pre">sd_card.img</span></code> file will be generated in the build directory.</p>
<ol class="arabic simple">
<li>Use software such as ‘Etcher’ to flash the <code class="docutils literal notranslate"><span class="pre">sd_card.img</span></code> file onto an SD Card.</li>
<li>After flashing is complete, insert the SD card in the SD card slot on board and power on the board.</li>
<li>Use ‘Teraterm’ to connect to COM port and wait for the system to boot up.</li>
<li>After the boot up is done, goto <code class="docutils literal notranslate"><span class="pre">/media/sd-mmcblk0p1</span></code> directory and run the executable file.</li>
</ol>
<p>Refer to the <a class="reference external" href="https://docs.xilinx.com/r/en-US/ug1393-vitis-application-acceleration/Running-the-Application-Hardware-Build">hw_run</a> section in Vitis Unified Software Development Platform 2024.1 Documentation.</p>
</div>
</div>
<div class="section" id="design-example-using-vitis-vision-aie-library">
<h1>Design example Using Vitis Vision AIE Library<a class="headerlink" href="#design-example-using-vitis-vision-aie-library" title="Permalink to this headline">¶</a></h1>
<p>The following example application performs a 2D filtering operation over a gray scale image. The
convolution kernel is a 3x3 window with floating point representation. The coefficients are
converted to fixed point representation before being passed to the AI Engine core for computation. The
results are cross validated against the OpenCV reference implementation. The example illustrates
both PLIO- and GMIO-based data transfers.</p>
<div class="section" id="adf-graph">
<h2>ADF Graph<a class="headerlink" href="#adf-graph" title="Permalink to this headline">¶</a></h2>
<p>An AI Engine program consists of a data flow graph specification written in C++. The dataflow graph consists of top-level ports,
kernel instances, and connectivity. a <code class="docutils literal notranslate"><span class="pre">graph.h</span></code> file is created which includes the header <code class="docutils literal notranslate"><span class="pre">adf.h</span></code>.</p>
<p>For more details on data flow graph creation, refer to <a class="reference external" href="https://docs.xilinx.com/r/en-US/ug1076-ai-engine-environment/Creating-a-Data-Flow-Graph-Including-Kernels">AI Engine Programming</a> .</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;kernels.h&quot;</span>
<span class="c1">#include &lt;adf.h&gt;</span>

<span class="n">using</span> <span class="n">namespace</span> <span class="n">adf</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">myGraph</span> <span class="p">:</span> <span class="n">public</span> <span class="n">adf</span><span class="p">::</span><span class="n">graph</span> <span class="p">{</span>
   <span class="n">public</span><span class="p">:</span>
    <span class="n">kernel</span> <span class="n">k1</span><span class="p">;</span>
    <span class="n">port</span><span class="o">&lt;</span><span class="nb">input</span><span class="o">&gt;</span> <span class="n">inptr</span><span class="p">;</span>
    <span class="n">port</span><span class="o">&lt;</span><span class="n">output</span><span class="o">&gt;</span> <span class="n">outptr</span><span class="p">;</span>
    <span class="n">port</span><span class="o">&lt;</span><span class="nb">input</span><span class="o">&gt;</span> <span class="n">kernelCoefficients</span><span class="p">;</span>

  <span class="n">myGraph</span><span class="p">()</span> <span class="p">{</span>
     <span class="n">k1</span> <span class="o">=</span> <span class="n">kernel</span><span class="p">::</span><span class="n">create</span><span class="p">(</span><span class="n">filter2D</span><span class="p">);</span>
     <span class="n">inptr</span> <span class="o">=</span> <span class="n">input_plio</span><span class="p">::</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;DataIn1&quot;</span><span class="p">,</span> <span class="n">adf</span><span class="p">::</span><span class="n">plio_128_bits</span><span class="p">,</span> <span class="s2">&quot;data/input_128x16.txt&quot;</span><span class="p">);</span>
     <span class="n">outptr</span> <span class="o">=</span> <span class="n">output_plio</span><span class="p">::</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;DataOut1&quot;</span><span class="p">,</span> <span class="n">adf</span><span class="p">::</span><span class="n">plio_128_bits</span><span class="p">,</span> <span class="s2">&quot;data/output.txt&quot;</span><span class="p">);</span>

     <span class="n">adf</span><span class="p">::</span><span class="n">connect</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">inptr</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k1</span><span class="o">.</span><span class="ow">in</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
     <span class="n">adf</span><span class="p">::</span><span class="n">connect</span><span class="o">&lt;</span><span class="n">parameter</span><span class="o">&gt;</span><span class="p">(</span><span class="n">kernelCoefficients</span><span class="p">,</span> <span class="k">async</span><span class="p">(</span><span class="n">k1</span><span class="o">.</span><span class="ow">in</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
     <span class="n">adf</span><span class="p">::</span><span class="n">connect</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">k1</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">outptr</span><span class="o">.</span><span class="ow">in</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>

     <span class="n">adf</span><span class="p">::</span><span class="n">dimensions</span><span class="p">(</span><span class="n">k1</span><span class="o">.</span><span class="ow">in</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">=</span> <span class="p">{</span><span class="n">ELEM_WITH_METADATA</span><span class="p">};</span>
     <span class="n">adf</span><span class="p">::</span><span class="n">dimensions</span><span class="p">(</span><span class="n">k1</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">=</span> <span class="p">{</span><span class="n">ELEM_WITH_METADATA</span><span class="p">};</span>

     <span class="n">source</span><span class="p">(</span><span class="n">k1</span><span class="p">)</span> <span class="o">=</span> <span class="s2">&quot;xf_filter2d.cc&quot;</span><span class="p">;</span>
     <span class="o">//</span> <span class="n">Initial</span> <span class="n">mapping</span>
     <span class="n">runtime</span><span class="o">&lt;</span><span class="n">ratio</span><span class="o">&gt;</span><span class="p">(</span><span class="n">k1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
  <span class="p">};</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="platform-ports">
<h2>Platform Ports<a class="headerlink" href="#platform-ports" title="Permalink to this headline">¶</a></h2>
<p>A top-level application file <code class="docutils literal notranslate"><span class="pre">graph.cpp</span></code> is created which contains an instance of the graph class and is connected to a simulation platform. A virtual platform specification helps to connect the data flow graph written with external I/O
mechanisms specific to the chosen target for testing or eventual deployment.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;graph.h&quot;</span>

<span class="o">//</span> <span class="n">Graph</span> <span class="nb">object</span>
   <span class="n">myGraph</span> <span class="n">filter_graph</span><span class="p">;</span>

   <span class="n">filter_graph</span><span class="o">.</span><span class="n">init</span><span class="p">();</span>
   <span class="n">filter_graph</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">filter_graph</span><span class="o">.</span><span class="n">kernelCoefficients</span><span class="p">,</span> <span class="n">float2fixed_coeff</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="o">&gt;</span><span class="p">(</span><span class="n">kData</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">(),</span> <span class="mi">16</span><span class="p">);</span>
   <span class="n">filter_graph</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
   <span class="n">filter_graph</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
</pre></div>
</div>
<ol class="arabic">
<li><p class="first">PLIO</p>
<p>A PLIO port attribute is used to make external stream connections that cross the AI Engine to programmable logic (PL) boundary. PLIO attributes are used to specify the port name, port bit width and the input/output file names.
Note that when simulating PLIO with data files, the data should be organized to accommodate both the width of the PL block as well as the data type of connecting port on the AI Engine block.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">Platform</span> <span class="n">ports</span>
   <span class="n">inptr</span> <span class="o">=</span> <span class="n">input_plio</span><span class="p">::</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;DataIn1&quot;</span><span class="p">,</span> <span class="n">adf</span><span class="p">::</span><span class="n">plio_128_bits</span><span class="p">,</span> <span class="s2">&quot;data/input_128x16.txt&quot;</span><span class="p">);</span>
   <span class="n">outptr</span> <span class="o">=</span> <span class="n">output_plio</span><span class="p">::</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;DataOut1&quot;</span><span class="p">,</span> <span class="n">adf</span><span class="p">::</span><span class="n">plio_128_bits</span><span class="p">,</span> <span class="s2">&quot;data/output.txt&quot;</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p class="first">GMIO</p>
<p>A GMIO port attribute is used to make external memory-mapped connections to or from the global memory. These connections are made between an AI Engine graph and the logical global memory ports of a hardware platform design.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span><span class="n">Platform</span> <span class="n">ports</span>
<span class="n">in1</span> <span class="o">=</span> <span class="n">input_gmio</span><span class="p">::</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;IN&quot;</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span><span class="mi">1000</span><span class="p">);</span>
<span class="n">out1</span> <span class="o">=</span> <span class="n">output_gmio</span><span class="p">::</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;OUT&quot;</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="host-code">
<h2>Host code<a class="headerlink" href="#host-code" title="Permalink to this headline">¶</a></h2>
<p>Host code <code class="docutils literal notranslate"><span class="pre">host.cpp</span></code> will be running on the host processor, which contains the code to initialize and run the datamovers and the ADF graph. XRT APIs are
used to create the required buffers in the device memory.</p>
<p>First a golden reference image is generated using OpenCV.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">run_opencv_ref</span><span class="p">(</span><span class="n">cv</span><span class="p">::</span><span class="n">Mat</span><span class="o">&amp;</span> <span class="n">srcImageR</span><span class="p">,</span> <span class="n">cv</span><span class="p">::</span><span class="n">Mat</span><span class="o">&amp;</span> <span class="n">dstRefImage</span><span class="p">,</span> <span class="nb">float</span> <span class="n">coeff</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span> <span class="p">{</span>
<span class="n">cv</span><span class="p">::</span><span class="n">Mat</span> <span class="n">tmpImage</span><span class="p">;</span>
<span class="n">cv</span><span class="p">::</span><span class="n">Mat</span> <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv</span><span class="p">::</span><span class="n">Mat</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">CV_32F</span><span class="p">,</span> <span class="n">coeff</span><span class="p">);</span>
<span class="n">cv</span><span class="p">::</span><span class="n">filter2D</span><span class="p">(</span><span class="n">srcImageR</span><span class="p">,</span> <span class="n">dstRefImage</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">cv</span><span class="p">::</span><span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">cv</span><span class="p">::</span><span class="n">BORDER_REPLICATE</span><span class="p">);</span>
<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then, <code class="docutils literal notranslate"><span class="pre">xclbin</span></code> is loaded on the device and the device handles are created.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xF</span><span class="p">::</span><span class="n">deviceInit</span><span class="p">(</span><span class="n">xclBinName</span><span class="p">);</span>
</pre></div>
</div>
<p>Buffers for input and output data are created using the XRT APIs and data from input <code class="docutils literal notranslate"><span class="pre">CV::Mat</span></code> is copied to the XRT buffer.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span><span class="o">*</span> <span class="n">srcData</span> <span class="o">=</span> <span class="n">nullptr</span><span class="p">;</span>
<span class="n">xrt</span><span class="p">::</span><span class="n">bo</span> <span class="n">src_hndl</span> <span class="o">=</span> <span class="n">xrt</span><span class="p">::</span><span class="n">bo</span><span class="p">(</span><span class="n">xF</span><span class="p">::</span><span class="n">gpDhdl</span><span class="p">,</span> <span class="p">(</span><span class="n">srcImageR</span><span class="o">.</span><span class="n">total</span><span class="p">()</span> <span class="o">*</span> <span class="n">srcImageR</span><span class="o">.</span><span class="n">elemSize</span><span class="p">()),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">srcData</span> <span class="o">=</span> <span class="n">src_hndl</span><span class="o">.</span><span class="n">map</span><span class="p">();</span>
<span class="n">memcpy</span><span class="p">(</span><span class="n">srcData</span><span class="p">,</span> <span class="n">srcImageR</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">srcImageR</span><span class="o">.</span><span class="n">total</span><span class="p">()</span> <span class="o">*</span> <span class="n">srcImageR</span><span class="o">.</span><span class="n">elemSize</span><span class="p">()));</span>

<span class="o">//</span> <span class="n">Allocate</span> <span class="n">output</span> <span class="n">buffer</span>
<span class="n">void</span><span class="o">*</span> <span class="n">dstData</span> <span class="o">=</span> <span class="n">nullptr</span><span class="p">;</span>
<span class="n">xrt</span><span class="p">::</span><span class="n">bo</span> <span class="n">ptr_dstHndl</span> <span class="o">=</span> <span class="n">xrt</span><span class="p">::</span><span class="n">bo</span><span class="p">(</span><span class="n">xF</span><span class="p">::</span><span class="n">gpDhdl</span><span class="p">,</span> <span class="p">(</span><span class="n">op_height</span> <span class="o">*</span> <span class="n">op_width</span> <span class="o">*</span> <span class="n">srcImageR</span><span class="o">.</span><span class="n">elemSize</span><span class="p">()),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">dstData</span> <span class="o">=</span> <span class="n">ptr_dstHndl</span><span class="o">.</span><span class="n">map</span><span class="p">();</span>
<span class="n">cv</span><span class="p">::</span><span class="n">Mat</span> <span class="n">dst</span><span class="p">(</span><span class="n">op_height</span><span class="p">,</span> <span class="n">op_width</span><span class="p">,</span> <span class="n">srcImageR</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span> <span class="n">dstData</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">xfcvDataMovers</span></code> objects tiler and stitcher are created. For more details on <code class="docutils literal notranslate"><span class="pre">xfcvDataMovers</span></code> refer to <a class="reference internal" href="#xfcvdatamovers-aie"><span class="std std-ref">xfcvDataMovers</span></a></p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xF</span><span class="p">::</span><span class="n">xfcvDataMovers</span><span class="o">&lt;</span><span class="n">xF</span><span class="p">::</span><span class="n">TILER</span><span class="p">,</span> <span class="n">int16_t</span><span class="p">,</span> <span class="n">MAX_TILE_HEIGHT</span><span class="p">,</span> <span class="n">MAX_TILE_WIDTH</span><span class="p">,</span> <span class="n">VECTORIZATION_FACTOR</span><span class="o">&gt;</span> <span class="n">tiler</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">xF</span><span class="p">::</span><span class="n">xfcvDataMovers</span><span class="o">&lt;</span><span class="n">xF</span><span class="p">::</span><span class="n">STITCHER</span><span class="p">,</span> <span class="n">int16_t</span><span class="p">,</span> <span class="n">MAX_TILE_HEIGHT</span><span class="p">,</span> <span class="n">MAX_TILE_WIDTH</span><span class="p">,</span> <span class="n">VECTORIZATION_FACTOR</span><span class="o">&gt;</span> <span class="n">stitcher</span><span class="p">;</span>
</pre></div>
</div>
<p>ADF graph is initialized and the filter coefficients are updated.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">auto</span> <span class="n">gHndl</span> <span class="o">=</span> <span class="n">xrt</span><span class="p">::</span><span class="n">graph</span><span class="p">(</span><span class="n">xF</span><span class="p">::</span><span class="n">gpDhdl</span><span class="p">,</span> <span class="n">xF</span><span class="p">::</span><span class="n">xclbin_uuid</span><span class="p">,</span> <span class="s2">&quot;filter_graph&quot;</span><span class="p">);</span>
<span class="n">gHndl</span><span class="o">.</span><span class="n">reset</span><span class="p">();</span>
<span class="n">gHndl</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;filter_graph.k1.in[1]&quot;</span><span class="p">,</span> <span class="n">float2fixed_coeff</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="o">&gt;</span><span class="p">(</span><span class="n">kData</span><span class="p">));</span>
</pre></div>
</div>
<p>Metadata containing the tile information is generated.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tiler</span><span class="o">.</span><span class="n">compute_metadata</span><span class="p">(</span><span class="n">srcImageR</span><span class="o">.</span><span class="n">size</span><span class="p">());</span>
</pre></div>
</div>
<p>The data transfer to AIE via datamovers is initiated along with graph run. Further execution waits until the data transfer is complete.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">auto</span> <span class="n">tiles_sz</span> <span class="o">=</span> <span class="n">tiler</span><span class="o">.</span><span class="n">host2aie_nb</span><span class="p">(</span><span class="o">&amp;</span><span class="n">src_hndl</span><span class="p">,</span> <span class="n">srcImageR</span><span class="o">.</span><span class="n">size</span><span class="p">());</span>
<span class="n">stitcher</span><span class="o">.</span><span class="n">aie2host_nb</span><span class="p">(</span><span class="o">&amp;</span><span class="n">dst_hndl</span><span class="p">,</span> <span class="n">dst</span><span class="o">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">tiles_sz</span><span class="p">);</span>

<span class="n">gHndl</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">tiles_sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">tiles_sz</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="n">gHndl</span><span class="o">.</span><span class="n">wait</span><span class="p">();</span>

<span class="n">tiler</span><span class="o">.</span><span class="n">wait</span><span class="p">();</span>
<span class="n">stitcher</span><span class="o">.</span><span class="n">wait</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="makefile">
<span id="aie-makefile"></span><h2>Makefile<a class="headerlink" href="#makefile" title="Permalink to this headline">¶</a></h2>
<p>Run ‘make help’ to get the list of supported commands and flows. Running the following commands will initiate a hardware build.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">&lt;</span> <span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">Vitis</span><span class="o">-</span><span class="n">installation</span><span class="o">-</span><span class="n">directory</span> <span class="o">&gt;/</span><span class="n">settings64</span><span class="o">.</span><span class="n">sh</span>
<span class="n">export</span> <span class="n">SYSROOT</span><span class="o">=&lt;</span> <span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">platform</span><span class="o">-</span><span class="n">sysroot</span> <span class="o">&gt;</span>
<span class="n">export</span> <span class="n">PLATFORM</span><span class="o">=&lt;</span> <span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">platform</span><span class="o">-</span><span class="n">directory</span> <span class="o">&gt;/&lt;</span> <span class="n">platform</span> <span class="o">&gt;.</span><span class="n">xpfm</span>
<span class="n">make</span> <span class="nb">all</span> <span class="n">TARGET</span><span class="o">=</span><span class="n">hw</span>

<span class="o">..</span> <span class="n">include</span><span class="p">::</span> <span class="n">include</span><span class="o">/</span><span class="n">f2d</span><span class="o">-</span><span class="n">l3</span><span class="o">-</span><span class="n">pipeline</span><span class="o">.</span><span class="n">rst</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
<!-- Atalwar: Moved the footer code to layout.html to resolve conflict with the Xilinx template -->
</footer>

        </div>
      </div>


	  <!-- Sphinx Page Footer block -->
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api-reference.html" class="btn btn-neutral float-right" title="Overview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="overview.html" class="btn btn-neutral float-left" title="Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p class="footerinfo">
      <span class="lastupdated">
        Last updated on May 28, 2024.
      </span>

    </p>
	<br>
  </div>
      </div>
    </section>


  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

   <script type="text/javascript">
    jQuery(function() { Search.loadIndex("searchindex.js"); });
  </script>

  <script type="text/javascript" id="searchindexloader"></script>


  
  
    
  



  <!--  Xilinx template footer block -->
							</div>
						</div>
					</div>
				</div>
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="footer parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
								<noindex>
                  <!-- make footer fixed - NileshP -->
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
                  <!-- make footer fixed NileshP-->
									<footer>
										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">
													<div class="row">
														<div class="footerSocial parbase">
														
															<div class="col-md-push-6 col-lg-push-6 col-md-6 col-lg-6">
																<div class="lang-select dropup hidden-md hidden-lg">
		<button data-toggle="dropdown">
			<span class="fas fa-globe" aria-hidden="true"></span>
			<span>
				
					English
				</span>
		<span class="far fa-angle-down" aria-hidden="true"></span>
	</button>
	<ul class="dropdown-menu">
		<li>
				<a target="_blank" href="https://japan.xilinx.com/" target="_self">
					日本語
				</a>
			</li>
		<li>
				<a target="_blank" href="https://china.xilinx.com/" target="_self">
					简体中文
				</a>
			</li>
		</ul>
	</div>
																<ul class="list-inline pull-right social-menu">
																	<li>
																		<a target="_blank" href="https://www.linkedin.com/company/xilinx">
																		<span class="linkedin icon"></span>
																		<span class="sr-only">Connect on LinkedIn</span>
																		</a>
																	</li>
																	<li>
																		<a target="_blank" href="https://www.twitter.com/XilinxInc">
																		<span class="twitter icon"></span>
																		<span class="sr-only">Follow us on Twitter</span>
																		</a>
																	</li>
																	<li>
																		<a target="_blank" href="https://www.facebook.com/XilinxInc">
																		<span class="facebook icon"></span>
																		<span class="sr-only">Connect on Facebook</span>
																		</a>
																	</li>
																	<li>
																		<a target="_blank" href="https://www.youtube.com/XilinxInc">
																		<span class="youtube icon"></span>
																		<span class="sr-only">Watch us on YouTube</span>
																		</a>
																	</li>
																	<li>
																		<a target="_blank" href="https://www.xilinx.com/registration/subscriber-signup.html">
																		<span class="newsletter icon"></span>
																		<span class="sr-only">Subscribe to Newsletter</span>
																		</a>
																	</li>
																</ul>
																	<div class="lang-select dropup hidden-xs hidden-sm">
	<button data-toggle="dropdown">
		<span class="fas fa-globe" aria-hidden="true"></span>
		<span>
			
				English
			</span>
		<span class="far fa-angle-down" aria-hidden="true"></span>
	</button>
	<ul class="dropdown-menu">
		<li>
				<a target="_blank" href="https://japan.xilinx.com/" target="_self">
					日本語
				</a>
			</li>
		<li>
				<a target="_blank" href="https://china.xilinx.com/" target="_self">
					简体中文
				</a>
			</li>
		</ul>
	</div>
															</div>
														</div>
														<div class="col-md-pull-5 col-lg-pull-5 col-md-5 col-lg-5">
															<span class="copyright">©2022 Advanced Micro Devices, Inc</span>
														</div>

													</div>
													                    <div class="movethisrowtoleft row">
                        <div class="col-xs-24">
                            <ul class="sub-menu">
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a></li>
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a></li>
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a></li>
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a></li>
                                <li><a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a></li>
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a></li>
                                <li><a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a></li>
								<li><a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a></li>
                                <li><a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></li>
                            </ul>
                        </div>
                    </div>
												</div>
											</div>
										</div>
									</footer>
								</noindex>
							</div>
						</div>
					</div>
				</div>
<div class="backToTop parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16"><noindex>
    <span data-component="backToTopButton" class="backToTopButton loaded">
        <ul>
            <li>
                <a href="https://www.author.xilinx.com/xx/rebrand/amd/en-amd-xilinx-header-footer.html#top" class="btn top">
                    <span class="fas fa-angle-up" aria-hidden="true"></span>
                </a>
            </li>
        </ul>
    </span>
</noindex></div>
			</div>
		</div>


		<script>window.CQ = window.CQ || {}</script>
		<script src="https://static.cloud.coveo.com/searchui/v2.4382/js/CoveoJsSearch.Lazy.min.js"></script>
		<script>
			var underscoreSetup = function () {
			  _.templateSettings.interpolate = /\{\{=([^-][\S\s]+?)\}\}/g;
			  _.templateSettings.evaluate = /\{\{([^-=][\S\s]+?)\}\}/g;
			  _.templateSettings.escape = /\{\{-([^=][\S\s]+?)\}\}/g;
			}

			underscoreSetup();
		</script>
	</body>
</html>